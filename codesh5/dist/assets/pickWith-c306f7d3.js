import"./el-tag-0dd03ffc.js";import{E as ee}from"./el-overlay-5da5aa34.js";import{_ as te,f as Q,t as g,u as ae,I as oe,r as m,a as le,J as ne,o as se,b as G,c as W,d as s,w as h,j as o,e as P,k,F as J,s as ie,N as ce,U as Z,O as de,p as re,i as ue,V as me,a0 as he,a1 as ve,X as ge,$ as pe,R as _e,a2 as be}from"./index-8b63aa92.js";/* empty css              */import{E as Ae,a as Fe}from"./el-select-3852e214.js";import"./el-popper-95a192dd.js";import{E as fe,a as we}from"./el-table-column-fc1dd70d.js";/* empty css              */import{B as A}from"./bignumber-266e6c56.js";import{c as De,b as Be}from"./pickWith-f29ca7d1.js";import{_ as Re,a as Ce}from"./btn_shoudong-07961c15.js";import{s as p,a as Ue}from"./function-call-21129ae9.js";import"./index-8dcd196a.js";import"./use-global-config-2bc38bcb.js";import"./objects-1c412bdf.js";const ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAAA8CAYAAADRy2JxAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RUNBM0RGNDAwNUU5MTFFQUJGRUFBQzhBMDZENDBERDQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RUNBM0RGNDEwNUU5MTFFQUJGRUFBQzhBMDZENDBERDQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFQ0EzREYzRTA1RTkxMUVBQkZFQUFDOEEwNkQ0MERENCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFQ0EzREYzRjA1RTkxMUVBQkZFQUFDOEEwNkQ0MERENCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsgzfqwAAAYkSURBVHja7Jv5b5RF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";const ye={setup(){Q.await("scanner",t=>{if(t!="null"){let e=t;if(new RegExp(/^124010[1-9][0-9]{2}(0[1-9]|1[0-2])((0[1-9])|((1|2)[0-9])|30|31)[0-9]{12}$/).test(e)&&e.length===25){let b={};b.fBarcode=e,De(b).then(C=>{if(C.data.data)return M(e).then(U=>{let T=U.shengchanriqi,L=U.kunxuhao,H=U.barcode,z=U.kunjingzhong,$={date:T,number:L,barcode:H,weight:z};V(g(d.value),$)});p({title:"提示",width:"600",message:C.data.message}).then(()=>{})})}else p({title:"提示",width:"600",message:"对不起，此条码不符合规范"}).then(()=>{})}else p({title:"提示",width:"600",message:"数据获取失败"}).then(()=>{})}),ae(),oe();const d=m([]),l=le(),I=m(""),a=m(""),u=m("0"),_=m(""),F=m("0"),f=m("0"),v=m("0"),D=m(!1),w=m(""),N=m(""),y=m(""),E=ne({barCodeSelectList:[]}),S=()=>history.back(),B=()=>{D.value=!1},x=()=>{D.value=!0};let R="";const j=(t,e,n)=>{R=g(t)},i=()=>{Q.scan()};se(()=>{let t=g(l.state.chukudanListInfo);g(l.state.carInfo.pizhong)&&(F.value=g(l.state.carInfo.pizhong).toFixed(4)),a.value=new A(t.F_PLANSUTTLE).minus(t.F_SUTTLE).toFixed(4),d.value=g(l.state.scandList);let e=g(l.state.scandCalculateData);Object.getOwnPropertyNames(e).length==0?(_.value=new A(t.F_PLANSUTTLE).minus(t.F_SUTTLE).toFixed(4),v.value=new A(F.value).plus(u.value).toFixed(4)):(u.value=e.yij1,_.value=e.ques,v.value=e.pz,f.value=e.yij2)});const X=()=>w.value==""?(p({title:"提示",width:"600",message:"请选择条形码"}).then(()=>{}),!1):(D.value=!1,M(w.value).then(t=>{let e=t.shengchanriqi,n=t.kunxuhao,c=t.barcode,b=t.kunjingzhong,C={date:e,number:n,barcode:c,weight:b};V(g(d.value),C)})),O=t=>{w.value="";let n={strBatchno:t.F_BATCHNUMBER+"-"+t.F_BATCHGROUP};Be(n).then(c=>{E.barCodeSelectList=c.data.data,E.barCodeSelectList.length>0?ie({message:"数据查询成功",type:"success",className:"particulars-detail-popup",overlay:!0}):p({title:"提示",width:"600",message:"没有查询到对应的条码数据"}).then(()=>{})}).catch(c=>{console.log(c)})},q=()=>{R?Ue({title:"提示",width:"600",message:"是否要剔除当前所选数据？"}).then(()=>{let t=d.value.filter(e=>e.barcode!=R.barcode);d.value=t,l.commit("setScandList",d.value),R="",Y(t)}).catch(t=>{console.log(t)}):p({title:"提示",width:"600",message:"请选择要剔除的的数据"}).then(()=>{})},K=()=>{if(d.value.length==0)return p({title:"提示",width:"600",message:"没有要处理的数据"}).then(()=>{}),!1;let t=g(l.state.chukudanListInfo),e=g(l.state.carInfo),n={};n.F_DELIVERYNO=t.F_DELIVERYNO,n.strSuttle=u.value,n.strTruckNo=e.chehao,n.weighthousename=e.chengfang,n.id=e.danjuhao,n.strDataId=e.DataId;let c=g(d.value).map(b=>b.barcode+",").join("");n.strBarcodes=c.substring(0,c.length-1),console.log(e),console.log(n)},Y=t=>{if(t.length>0)for(let n=0;n<t.length;n++){let c=t[n];u.value=new A(u.value).plus(new A(c.weight).dividedBy(1e3)).toFixed(4),_.value=new A(a.value).minus(u.value).toFixed(4),v.value=new A(F.value).plus(u.value).toFixed(4),d.value=t,f.value=t.length,I.value=Math.random()}else u.value="0",_.value=a.value,f.value="0",v.value=new A(F.value).plus(u.value).toFixed(4);let e={};e.yij1=u.value,e.ques=_.value,e.pz=v.value,e.yij2=f.value,l.commit("setScandCalculateData",e),l.commit("setScandList",d.value),_.value<0&&p({title:"提示",width:"600",message:"缺少数值已为负数"}).then(()=>{})},M=t=>{let e=t.split("");const n=e.slice(0,3).join(""),c=e.slice(3,5).join(""),b=e.slice(5,7).join(""),C=e.slice(7,13).join(""),U=e.slice(13,17).join(""),T=e.slice(17,20).join(""),L=e.slice(20,24).join("")+"."+e[24];return new Promise((H,z)=>{H({barcode:t,qiyedaima:n,chanpinleibie:c,chanpindengji:b,shengchanriqi:C,chanpinpihao:U,kunxuhao:T,kunjingzhong:L})})},V=(t,e)=>{if(t.find(c=>c.barcode===e.barcode))p({title:"提示",width:"600",message:"该批次已经选择，请勿重复选择"}).then(()=>{});else{let c=[];t.unshift(e),c=t,Y(c)}};return{barCodeSelect:w,F_BATCHGROUP:N,F_BATCHNUMBER:y,listData:E,itemKey:I,yingj:a,yij1:u,ques:_,pizhong:F,yij2:f,pz:v,tableData:d,centerDialogVisibleTXM:D,passedTXMClick:X,onSubmit:O,closeTXMClick:B,checkIfExist:V,decode:M,scanCode:i,onClickLeft:S,onHandle:x,onConfirm:K,selectRow:j,onDelete:q}}},r=d=>(re("data-v-3e0a847e"),d=d(),ue(),d),Ee={class:"container"},Ge={class:"info-container"},Ie=r(()=>o("span",{class:"title"},"应拣",-1)),Ne=r(()=>o("span",{class:"title"},"已拣",-1)),Se=r(()=>o("span",{class:"title"},"缺少",-1)),xe=r(()=>o("span",{class:"title"},"皮重",-1)),je=r(()=>o("span",{class:"title"},"捆数",-1)),Me=r(()=>o("span",{class:"title"},"合计",-1)),Ve={class:"btn-area"},Te=r(()=>o("img",{src:Re,alt:""},null,-1)),Le=r(()=>o("div",null,"确认",-1)),He=[Te,Le],Ze=r(()=>o("img",{src:Ce,alt:"",type:"primary"},null,-1)),Ye=r(()=>o("div",null,"手动",-1)),ze=[Ze,Ye],Qe=r(()=>o("img",{src:ke,alt:"",type:"primary"},null,-1)),We=r(()=>o("div",null,"剔除",-1)),Pe=[Qe,We],Je={style:{margin:"16px"}},Xe={style:{"margin-top":"10px"}},Oe=r(()=>o("p",null,"条形码",-1));function qe(d,l,I,a,u,_){const F=me,f=ce,v=we,D=fe,w=he,N=ve,y=ge,E=Ae,S=Fe,B=pe,x=_e,R=be,j=ee;return G(),W(J,null,[s(f,{title:"拣配",class:"page-nav-bar","left-arrow":"",onClickLeft:a.onClickLeft},{right:h(()=>[s(F,{onClick:a.scanCode,style:{color:"#FFFFFF"},name:"scan",size:"40"},null,8,["onClick"])]),_:1},8,["onClickLeft"]),o("div",Ee,[(G(),P(D,{data:a.tableData,style:{height:"260px"},id:"data-area1",key:a.itemKey,"highlight-current-row":"",onRowClick:a.selectRow},{default:h(()=>[s(v,{fixed:"",prop:"date",label:"日期"}),s(v,{prop:"number",label:"包号"}),s(v,{prop:"weight",label:"重量"}),s(v,{prop:"barcode",label:"条码",width:"250"})]),_:1},8,["data","onRowClick"])),o("div",Ge,[Ie,Ne,Se,o("span",null,k(a.yingj),1),o("span",null,k(a.yij1),1),o("span",null,k(a.ques),1),xe,je,Me,o("span",null,k(a.pizhong),1),o("span",null,k(a.yij2),1),o("span",null,k(a.pz),1)]),o("div",Ve,[o("div",{onClick:l[0]||(l[0]=(...i)=>a.onConfirm&&a.onConfirm(...i))},He),o("div",{onClick:l[1]||(l[1]=(...i)=>a.onHandle&&a.onHandle(...i))},ze),o("div",{onClick:l[2]||(l[2]=(...i)=>a.onDelete&&a.onDelete(...i))},Pe)])]),s(j,{modelValue:a.centerDialogVisibleTXM,"onUpdate:modelValue":l[6]||(l[6]=i=>a.centerDialogVisibleTXM=i),title:"手动不合格条码",width:"96%","align-center":""},{default:h(()=>[s(R,{onSubmit:a.onSubmit},{default:h(()=>[s(N,{inset:""},{default:h(()=>[s(w,{modelValue:a.F_BATCHGROUP,"onUpdate:modelValue":l[3]||(l[3]=i=>a.F_BATCHGROUP=i),name:"F_BATCHGROUP",label:"批次号",placeholder:"批次号(四位)",rules:[{required:!0,message:"请填写批次号"}]},null,8,["modelValue"]),s(w,{modelValue:a.F_BATCHNUMBER,"onUpdate:modelValue":l[4]||(l[4]=i=>a.F_BATCHNUMBER=i),name:"F_BATCHNUMBER",label:"编号",placeholder:"编号(三位)",rules:[{required:!0,message:"请填写编号"}]},null,8,["modelValue"])]),_:1}),o("div",Je,[s(y,{square:"",icon:"search",block:"",type:"primary","native-type":"submit",style:{"background-color":"#003363",color:"#FFFFFF"}},{default:h(()=>[Z(" 查询 ")]),_:1}),o("div",Xe,[Oe,s(S,{modelValue:a.barCodeSelect,"onUpdate:modelValue":l[5]||(l[5]=i=>a.barCodeSelect=i),placeholder:"条形码",style:{width:"100%"}},{default:h(()=>[(G(!0),W(J,null,de(a.listData.barCodeSelectList,i=>(G(),P(E,{key:i.F_BARCODE,label:i.F_BARCODE,value:i.F_BARCODE},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s(x,{style:{"margin-top":"15px"}},{default:h(()=>[s(B,{span:"2"}),s(B,{span:"10"},{default:h(()=>[s(y,{icon:"passed",style:{"background-color":"#003363",color:"#FFFFFF"},onClick:a.passedTXMClick},{default:h(()=>[Z("确定 ")]),_:1},8,["onClick"])]),_:1}),s(B,{span:"10",style:{"text-align":"center"}},{default:h(()=>[s(y,{icon:"close",style:{"background-color":"red",color:"#FFFFFF"},onClick:a.closeTXMClick},{default:h(()=>[Z("退出 ")]),_:1},8,["onClick"])]),_:1}),s(B,{span:"2"})]),_:1})])]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])],64)}const ht=te(ye,[["render",qe],["__scopeId","data-v-3e0a847e"]]);export{ht as default};
