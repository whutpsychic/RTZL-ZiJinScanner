import{bg as J,ba as Q,O as ee,a3 as x,L as te,e as g,n as S,t as O,a4 as L,p as i,i as k,ai as _,ac as oe,ay as B,c as R,d as N,a as y,au as Y,J as ne,ap as K,$,a0 as j,w as M,a8 as z,f as ae,ae as se,q as le,ao as ce,V as re,aZ as ie,H as ue,h as de,av as ve,I as fe,aU as me,W as ye}from"./index-ce976914.js";function he(e,{args:t=[],done:o,canceled:a}){if(e){const n=e.apply(null,t);J(n)?n.then(l=>{l?o():a&&a()}).catch(Q):n?o():a&&a()}else o()}const X=Symbol();function Ee(e){const t=ee(X,null);t&&x(t,o=>{o&&e()})}function H(e){const t=te();t&&g(t.proxy,e)}let Ie=2e3;const Ce=()=>++Ie,V={show:Boolean,zIndex:S,overlay:O,duration:S,teleport:[String,Object],lockScroll:O,lazyRender:O,beforeClose:Function,overlayStyle:Object,overlayClass:L,transitionAppear:Boolean,closeOnClickOverlay:O},De=Object.keys(V);function Oe(e,t){return e>t?"horizontal":t>e?"vertical":""}function pe(){const e=i(0),t=i(0),o=i(0),a=i(0),n=i(0),l=i(0),s=i(""),r=()=>s.value==="vertical",p=()=>s.value==="horizontal",h=()=>{o.value=0,a.value=0,n.value=0,l.value=0,s.value=""};return{move:v=>{const d=v.touches[0];o.value=(d.clientX<0?0:d.clientX)-e.value,a.value=d.clientY-t.value,n.value=Math.abs(o.value),l.value=Math.abs(a.value);const C=10;(!s.value||n.value<C&&l.value<C)&&(s.value=Oe(n.value,l.value))},start:v=>{h(),e.value=v.touches[0].clientX,t.value=v.touches[0].clientY},reset:h,startX:e,startY:t,deltaX:o,deltaY:a,offsetX:n,offsetY:l,direction:s,isVertical:r,isHorizontal:p}}let b=0;const E="van-overflow-hidden";function be(e,t){const o=pe(),a="01",n="10",l=u=>{o.move(u);const I=o.deltaY.value>0?n:a,v=k.getScrollParent(u.target,e.value),{scrollHeight:d,offsetHeight:C,scrollTop:w}=v;let f="11";w===0?f=C>=d?"00":"01":w+C>=d&&(f="10"),f!=="11"&&o.isVertical()&&!(parseInt(f,2)&parseInt(I,2))&&B(u,!0)},s=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",l,{passive:!1}),b||document.body.classList.add(E),b++},r=()=>{b&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",l),b--,b||document.body.classList.remove(E))},p=()=>t()&&s(),h=()=>t()&&r();k.onMountedOrActivated(p),_(h),oe(h),x(t,u=>{u?s():r()})}function U(e){const t=i(!1);return x(e,o=>{o&&(t.value=o)},{immediate:!0}),o=>()=>t.value?o():null}const[we,Pe]=R("overlay"),Se={show:Boolean,zIndex:S,duration:S,className:L,lockScroll:O,lazyRender:O,customStyle:Object};var ke=N({name:we,props:Se,setup(e,{slots:t}){const o=i(),a=U(()=>e.show||!e.lazyRender),n=s=>{e.lockScroll&&B(s,!0)},l=a(()=>{var s;const r=g(ne(e.zIndex),e.customStyle);return K(e.duration)&&(r.animationDuration=`${e.duration}s`),$(y("div",{ref:o,style:r,class:[Pe(),e.className]},[(s=t.default)==null?void 0:s.call(t)]),[[j,e.show]])});return k.useEventListener("touchmove",n,{target:o}),()=>y(Y,{name:"van-fade",appear:!0},{default:l})}});const xe=M(ke),ge=g({},V,{round:Boolean,position:z("center"),closeIcon:z("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:z("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Te,D]=R("popup");var ze=N({name:Te,inheritAttrs:!1,props:ge,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:o,slots:a}){let n,l;const s=i(),r=i(),p=U(()=>e.show||!e.lazyRender),h=ae(()=>{const c={zIndex:s.value};if(K(e.duration)){const m=e.position==="center"?"animationDuration":"transitionDuration";c[m]=`${e.duration}s`}return c}),u=()=>{n||(n=!0,s.value=e.zIndex!==void 0?+e.zIndex:Ce(),t("open"))},I=()=>{n&&he(e.beforeClose,{done(){n=!1,t("close"),t("update:show",!1)}})},v=c=>{t("clickOverlay",c),e.closeOnClickOverlay&&I()},d=()=>{if(e.overlay)return y(xe,{show:e.show,class:e.overlayClass,zIndex:s.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:v},{default:a["overlay-content"]})},C=c=>{t("clickCloseIcon",c),I()},w=()=>{if(e.closeable)return y(fe,{role:"button",tabindex:0,name:e.closeIcon,class:[D("close-icon",e.closeIconPosition),ve],classPrefix:e.iconPrefix,onClick:C},null)};let f;const Z=()=>{f&&clearTimeout(f),f=setTimeout(()=>{t("opened")})},F=()=>t("closed"),G=c=>t("keydown",c),W=p(()=>{var c;const{round:m,position:P,safeAreaInsetTop:T,safeAreaInsetBottom:q}=e;return $(y("div",de({ref:r,style:h.value,role:"dialog",tabindex:0,class:[D({round:m,[P]:P}),{"van-safe-area-top":T,"van-safe-area-bottom":q}],onKeydown:G},o),[(c=a.default)==null?void 0:c.call(a),w()]),[[j,e.show]])}),A=()=>{const{position:c,transition:m,transitionAppear:P}=e,T=c==="center"?"van-fade":`van-popup-slide-${c}`;return y(Y,{name:m||T,appear:P,onAfterEnter:Z,onAfterLeave:F},{default:W})};return x(()=>e.show,c=>{c&&!n&&(u(),o.tabindex===0&&se(()=>{var m;(m=r.value)==null||m.focus()})),!c&&n&&(n=!1,t("close"))}),H({popupRef:r}),be(r,()=>e.show&&e.lockScroll),k.useEventListener("popstate",()=>{e.closeOnPopstate&&(I(),l=!1)}),le(()=>{e.show&&u()}),ce(()=>{l&&(t("update:show",!0),l=!1)}),_(()=>{e.show&&e.teleport&&(I(),l=!0)}),re(X,()=>e.show),()=>e.teleport?y(ie,{to:e.teleport},{default:()=>[d(),A()]}):y(ue,null,[d(),A()])}});const Le=M(ze);function _e(){const e=ye({show:!1}),t=n=>{e.show=n},o=n=>{g(e,n,{transitionAppear:!0}),t(!0)},a=()=>t(!1);return H({open:o,close:a,toggle:t}),{open:o,close:a,state:e,toggle:t}}function Be(e){const t=me(e),o=document.createElement("div");return document.body.appendChild(o),{instance:t.mount(o),unmount(){t.unmount(),document.body.removeChild(o)}}}export{Le as P,pe as a,De as b,he as c,_e as d,Be as m,Ee as o,V as p,H as u};
