System.register(["./index-legacy-f9152eff.js","./el-card-legacy-d42ea1a3.js","./index-legacy-2f76a666.js","./el-tag-legacy-cf3cc70f.js","./el-select-legacy-248d8db7.js","./el-popper-legacy-d80e9ed8.js","./index-legacy-d1883c5a.js","./index-legacy-eda59a38.js","./gradeDetermination-legacy-1bcceb23.js","./index-legacy-c3f1f91b.js","./index-legacy-fcd4d1d3.js"],(function(e,a){"use strict";var l,o,t,n,r,i,d,s,c,u,v,p,g,b,m,y,h,f,_,k,w,x,C,I,D,j,J,L,S,R,F,z,U,N,V,P,q,M;return{setters:[e=>{l=e._,o=e.u,t=e.D,n=e.r,r=e.E,i=e.H,d=e.o,s=e.b,c=e.c,u=e.i,v=e.d,p=e.w,g=e.I,b=e.O,m=e.P,y=e.N,h=e.Y,f=e.U,_=e.V,k=e.j,w=e.F,x=e.M,C=e.e,I=e.f,D=e.Z,j=e.a4,J=e.a5,L=e.a1,S=e.a2,R=e.p,F=e.h},e=>{z=e.E},null,null,e=>{U=e.E,N=e.a},null,null,null,e=>{V=e.d,P=e.g,q=e.b,M=e.e},null,null],execute:function(){var a=document.createElement("style");a.textContent=".van-radio-group--horizontal{display:flex;flex-wrap:wrap}:root{--van-radio-size: 20px;--van-radio-border-color: var(--van-gray-5);--van-radio-duration: var(--van-duration-fast);--van-radio-label-margin: var(--van-padding-xs);--van-radio-label-color: var(--van-text-color);--van-radio-checked-icon-color: var(--van-primary-color);--van-radio-disabled-icon-color: var(--van-gray-5);--van-radio-disabled-label-color: var(--van-text-color-3);--van-radio-disabled-background: var(--van-border-color)}.van-radio{display:flex;align-items:center;overflow:hidden;cursor:pointer;-webkit-user-select:none;user-select:none}.van-radio--disabled{cursor:not-allowed}.van-radio--label-disabled{cursor:default}.van-radio--horizontal{margin-right:var(--van-padding-sm)}.van-radio__icon{flex:none;height:1em;font-size:var(--van-radio-size);line-height:1em;cursor:pointer}.van-radio__icon .van-icon{display:block;box-sizing:border-box;width:1.25em;height:1.25em;color:transparent;font-size:.8em;line-height:1.25;text-align:center;border:1px solid var(--van-radio-border-color);transition-duration:var(--van-radio-duration);transition-property:color,border-color,background-color}.van-radio__icon--round .van-icon{border-radius:100%}.van-radio__icon--checked .van-icon{color:var(--van-white);background-color:var(--van-radio-checked-icon-color);border-color:var(--van-radio-checked-icon-color)}.van-radio__icon--disabled{cursor:not-allowed}.van-radio__icon--disabled .van-icon{background-color:var(--van-radio-disabled-background);border-color:var(--van-radio-disabled-icon-color)}.van-radio__icon--disabled.van-radio__icon--checked .van-icon{color:var(--van-radio-disabled-icon-color)}.van-radio__label{margin-left:var(--van-radio-label-margin);color:var(--van-radio-label-color);line-height:var(--van-radio-size)}.van-radio__label--left{margin:0 var(--van-radio-label-margin) 0 0}.van-radio__label--disabled{color:var(--van-radio-disabled-label-color)}.header[data-v-d05b5414]{width:100%;height:58px;line-height:58px;position:absolute;z-index:5;top:0}.content[data-v-d05b5414]{width:100%;overflow:scroll;top:58px;position:absolute;z-index:10;bottom:5px}\n",document.head.appendChild(a);const Y={setup(){const e=o(),a=t(),l=n(""),s=n(""),c=n(""),u=n(""),v=n(""),p=n(""),y=n([]),h=n([]),f=n([]),_=n(!1),k=n(!1),w=n([]),x=r({yjtJyInformationData:{},typeCodeList:[],alterReasonList:[]}),C=n(!1);x.yjtJyInformationData=JSON.parse(decodeURIComponent(a.query.yjtJyInformation));const I=n(JSON.parse(decodeURIComponent(a.query.exterior))),D=n(JSON.parse(decodeURIComponent(a.query.tabIndex)));i.await("takePhoto",(e=>{if("null"!=e){let a={};a.index=y.value.length+1,a.base64Img=e,y.value.push(a),h.value.push(e);let l=new FormData,o="/cathodeCopper/"+x.yjtJyInformationData.batchgroup+"/"+x.yjtJyInformationData.batchnumber;l.append("file",function(e){let a=e.split(","),l=a[0].match(/:(.*?);/)[1],o=atob(a[1]),t=o.length,n=new Uint8Array(t);for(;t--;)n[t]=o.charCodeAt(t);let r=Math.random().toString(36).slice(-8),i=l.split("/")[1];return new File([n],r+"."+i,{type:l})}(e)),l.append("path",o),V(l).then((e=>{let a={};a.fileName=e.data.fileName,a.fileUrl=e.data.fileUrl,a.index=y.value.length,f.value.push(a)})).catch((e=>{console.log(e)}))}})),"1"==I.value?(l.value="qualified",s.value="合格品类型"):"2"==I.value&&(l.value="unqualified",s.value="不合格品类型"),d((()=>{j(l.value),J()}));const j=e=>{let a={};a.typeCode=e,P(a).then((e=>{200==e.data.code&&(x.typeCodeList=e.data.data,v.value=String(x.typeCodeList[0].id))})).catch((e=>{console.log(e)}))},J=()=>{let e={},a={},l={limit:9999,offset:1,blockId:"paramBlock",data:{}};a.paramBlock=l,e.blocks=a,q(e).then((e=>{x.alterReasonList=e.data.blocks.resultBlock.data})).catch((e=>{console.log(e)}))};return{imgList:w,showImage:_,showLabelImage:k,fileList:y,base64ImgList:h,imagePath:f,takePhotoState:p,alterReason:u,remarks:c,typeCode:l,typeCodeText:s,listData:x,exterior:I,tabIndex:D,typeCodeChecked:v,disabled:C,seeImg:()=>{w.value=h.value,_.value=!0},takePhotoZJ:()=>{i.takePhoto()},onClickLeft:()=>{e.back()},dateFormat:(e,a)=>{let l,o=new Date(a);const t={"Y+":o.getFullYear().toString(),"m+":(o.getMonth()+1).toString(),"d+":o.getDate().toString(),"H+":o.getHours().toString(),"M+":o.getMinutes().toString(),"S+":o.getSeconds().toString()};for(let n in t)l=new RegExp("("+n+")").exec(e),l&&(e=e.replace(l[1],1==l[1].length?t[n]:t[n].padStart(l[1].length,"0")));return e},beforeDelete:(e,a)=>{f.value=f.value.filter((a=>a.index!=e)),y.value=y.value.filter((a=>a.index!=e)),h.value=h.value.filter((e=>e!=a))},conservation:()=>{if(C.value=!0,0==f.value.length)return g({message:"请上传质检照片",type:"fail",overlay:!0,className:"particulars-detail-popup"}),C.value=!1,!1;if(1==D.value&&!u.value)return g({message:"请选择或者填写改判理由",type:"fail",overlay:!0,className:"particulars-detail-popup"}),C.value=!1,!1;b({duration:0,forbidClick:!0,className:"particulars-detail-popup",overlay:!0,message:"正在质检..."});let a={data:[],active:"",exterior:"",remarks:"",alterReason:"",typeCodeChecked:"",fileList:[],labelFileList:[]},l=[];l.push(x.yjtJyInformationData),a.data=l,a.typeCodeChecked=v.value,a.active=D.value,a.exterior=I.value,a.remarks=c.value,a.alterReason=u.value,a.fileList=f.value,M(a).then((a=>{m(),200==a.data.code&&(g({message:"质检成功",type:"success",className:"particulars-detail-popup",overlay:!0}),C.value=!1,e.push({path:"/gradeDetermination",query:{barcode:x.yjtJyInformationData.barcode,tabState:"1"}}))})).catch((e=>{console.log(e),C.value=!1,m()}))},getTypeCodeData:j,getAlterReasonQuery:J}}},E=e=>(R("data-v-d05b5414"),e=e(),F(),e),H={class:"container"},O={class:"header"},Z={class:"content"},A=E((()=>u("span",{style:{"font-weight":"bold"}},"编号：",-1))),B=E((()=>u("span",{style:{"font-weight":"bold"}},"重量：",-1))),T=E((()=>u("span",{style:{"font-weight":"bold"}},"标准：",-1))),Q=E((()=>u("span",{style:{"font-weight":"bold"}},"计量员：",-1))),G=E((()=>u("span",{style:{"font-weight":"bold"}},"扫描人：",-1))),K=E((()=>u("span",{style:{"font-weight":"bold"}},"生产日期：",-1))),W=E((()=>u("span",{style:{color:"red"}},"*",-1))),X=E((()=>u("span",{style:{color:"red"}},"*",-1))),$={class:"van-uploader"},ee={class:"van-uploader__wrapper"},ae={class:"van-image van-uploader__preview-image"},le=["src"],oe=["onClick"],te=[E((()=>u("i",{class:"van-badge__wrapper van-icon van-icon-cross van-uploader__preview-delete-icon"},null,-1)))],ne=[E((()=>u("i",{class:"van-badge__wrapper van-icon van-icon-photograph van-uploader__upload-icon"},null,-1)))],re={key:0},ie=E((()=>u("span",{style:{color:"red"}},"*",-1)));e("default",l(Y,[["render",function(e,a,l,o,t,n){const r=y,i=D,d=j,g=J,b=U,m=N,R=L,F=S,V=z,P=h,q=f;return s(),c("div",H,[u("div",O,[v(r,{title:"品级质检",class:"page-nav-bar","left-arrow":"",onClickLeft:o.onClickLeft},null,8,["onClickLeft"])]),u("div",Z,[v(V,{class:"box-card",shadow:"always"},{default:p((()=>[v(i,{"content-position":"left"},{default:p((()=>[_("基本信息")])),_:1}),u("div",null,[u("p",null,[A,u("span",null,k(o.listData.yjtJyInformationData.batchnumber),1)]),u("p",null,[B,u("span",null,k(parseFloat(o.listData.yjtJyInformationData.suttle))+k(o.listData.yjtJyInformationData.unit),1)]),u("p",null,[T,u("span",null,k(o.listData.yjtJyInformationData.standard),1)]),u("p",null,[Q,u("span",null,k(o.listData.yjtJyInformationData.suttleperson),1),_("      "),G,u("span",null,k(o.listData.yjtJyInformationData.scanUser),1)]),u("p",null,[K,u("span",null,k(o.dateFormat("YYYY-mm-dd HH:MM:SS",o.listData.yjtJyInformationData.proDate)),1)])]),u("div",null,[v(i,{"content-position":"left"},{default:p((()=>[W,_(k(o.typeCodeText),1)])),_:1}),v(g,{modelValue:o.typeCodeChecked,"onUpdate:modelValue":a[0]||(a[0]=e=>o.typeCodeChecked=e),direction:"horizontal"},{default:p((()=>[(s(!0),c(w,null,x(o.listData.typeCodeList,((e,a)=>(s(),C(d,{name:String(e.id)},{default:p((()=>[_(k(e.name),1)])),_:2},1032,["name"])))),256))])),_:1},8,["modelValue"])]),u("div",null,[v(i,{"content-position":"left"},{default:p((()=>[X,_(" 质检照片")])),_:1}),u("div",$,[u("div",ee,[(s(!0),c(w,null,x(o.fileList,((e,l)=>(s(),c("div",{class:"van-uploader__preview",key:e.index},[u("div",ae,[u("img",{class:"van-image__img",src:e.base64Img,style:{"object-fit":"cover"},onClick:a[1]||(a[1]=(...e)=>o.seeImg&&o.seeImg(...e))},null,8,le)]),u("div",{role:"button",class:"van-uploader__preview-delete van-uploader__preview-delete--shadow",tabindex:"0","aria-label":"删除",onClick:a=>o.beforeDelete(e.index,e.base64Img)},te,8,oe)])))),128)),u("div",{class:"van-uploader__upload",onClick:a[2]||(a[2]=(...e)=>o.takePhotoZJ&&o.takePhotoZJ(...e))},ne)])])]),1==o.tabIndex?(s(),c("div",re,[v(i,{"content-position":"left"},{default:p((()=>[ie,_("改判理由")])),_:1}),v(m,{modelValue:o.alterReason,"onUpdate:modelValue":a[3]||(a[3]=e=>o.alterReason=e),filterable:"",clearable:"","allow-create":"",placeholder:"改判理由",style:{width:"100%"}},{default:p((()=>[(s(!0),c(w,null,x(o.listData.alterReasonList,(e=>(s(),C(b,{key:e.alterReason,label:e.alterReason,value:e.alterReason},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])):I("",!0),u("div",null,[v(i,{"content-position":"left"},{default:p((()=>[_("备注")])),_:1}),v(F,{inset:""},{default:p((()=>[v(R,{modelValue:o.remarks,"onUpdate:modelValue":a[4]||(a[4]=e=>o.remarks=e),rows:"1",autosize:"",label:"备注",type:"textarea",placeholder:"请输入备注"},null,8,["modelValue"])])),_:1})])])),_:1}),v(P,{type:"primary",size:"large",disabled:o.disabled,style:{width:"80%",position:"absolute",left:"10%","margin-top":"15px","background-color":"#003363",color:"#FFFFFF"},onClick:o.conservation},{default:p((()=>[_("提交 ")])),_:1},8,["disabled","onClick"]),v(q,{show:o.showImage,"onUpdate:show":a[5]||(a[5]=e=>o.showImage=e),images:o.imgList,closeable:!0,loop:!1,closeOnPopstate:!0},null,8,["show","images"])])])}],["__scopeId","data-v-d05b5414"]]))}}}));
